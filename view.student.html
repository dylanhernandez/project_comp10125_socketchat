<!doctype html>
<!--
| Statement of Authorship:
| StAuth10065: I Dylan Hernandez, 000307857 certify that this material is my original work.
| No other person's work has been used without due acknowledgement.
| I have not made my work available to anyone else.
-->
<html>
    <head>
        <title>Lab 6 [STUDENT]</title>
        <link href="https://maxcdn.bootstrapcdn.com/bootswatch/3.3.7/sandstone/bootstrap.min.css" rel="stylesheet" integrity="sha384-G3G7OsJCbOk1USkOY4RfeX1z27YaWrZ1YuaQ5tbuawed9IoreRDpWpTkZLXQfPm3" crossorigin="anonymous">
        <style>*,html {  -webkit-border-radius: 0 !important;  -moz-border-radius: 0 !important;  border-radius: 0 !important;  }</style>
    </head>
    <body>
    <nav class="navbar navbar-default navbar-fixed-top">
        <div class="container">
            <p class="navbar-text">LAB 6 - SOCKET.IO CHAT</p>
            <p class="navbar-text">Classroom Collaboration [STUDENT]</p>
        </div>
    </nav>
        <div class="container" style="margin-top:100px">
            <div class="row">
                <div class="col-xs-12">
                    <div id="studentNameFormPanel" class="panel panel-default">
                        <div class="panel-heading">
                            Student Name
                        </div>
                        <div class="panel-body">
                            <form id="studentNameForm">
                                <div class="row">
                                    <div class="col-xs-12">
                                        <div class="form-group">
                                            <label>Enter Your Name:</label>
                                            <input type="text" id="nameInput" class="form-control">
                                        </div>
                                    </div>
                                    <div class="col-xs-12 col-sm-6 col-md-4">
                                        <br />
                                        <input type="submit" class="btn btn-block btn-default">
                                    </div>
                                </div>
                            </form>
                        </div>
                    </div>
                    <div id="waitingPanel" class="panel panel-default" style="display:none;">
                        <div class="panel-body">
                            <h3>
                                Waiting for question &hellip;
                            </h3>
                        </div>
                    </div>
                    <div id="shortAnswerPanel" class="panel panel-default" style="display:none;">
                        <div class="panel-body">
                            <form id="shortAnswerForm">
                                <div class="row">
                                    <div class="col-xs-12">
                                        <div class="form-group">
                                            <label for="shortAnswerQuestion">Question:</label>
                                            <h4><div id="shortAnswerQuestion"></div></h4>
                                        </div>
                                        <div class="form-group">
                                            <label for="shortAnswerAnswer">Answer:</label>
                                            <input type="text" id="shortAnswerAnswer" class="form-control">
                                        </div>
                                    </div>
                                    <div class="col-xs-12 col-sm-6 col-md-4">
                                        <br />
                                        <input type="submit" class="btn btn-block btn-default">
                                        <br />
                                    </div>
                                </div>
                            </form>
                            <h4>
                                <span id="answerResult"></span>
                            </h4>
                        </div>
                    </div>
                    <div id="multipleChoicePanel" class="panel panel-default" style="display: none;">
                        <div class="panel-body">
                            <form id="multipleChoiceForm">
                                <div class="row">
                                    <div class="col-xs-12">
                                        <div class="form-group">
                                            <label for="multipleChoiceQuestion">Question:</label>
                                            <h4><div id="multipleChoiceQuestion"></div></h4>
                                        </div>
                                        <div class="form-group">
                                            <div class="input-group" id="group1MC" style="display: none;">
                                                <span class="input-group-addon">
                                                    <input type="radio" id="answer1MC" name="mc">
                                                </span>
                                                <input type="text" class="form-control" id="select1MC" value="" readonly>
                                            </div>
                                            <div class="input-group" id="group2MC" style="display: none;">
                                                <span class="input-group-addon">
                                                    <input type="radio" id="answer2MC" name="mc">
                                                </span>
                                                <input type="text" class="form-control" id="select2MC" value="" readonly>
                                            </div>
                                            <div class="input-group" id="group3MC" style="display: none;">
                                                <span class="input-group-addon">
                                                    <input type="radio" id="answer3MC" name="mc">
                                                </span>
                                                <input type="text" class="form-control" id="select3MC" value="" readonly>
                                            </div>
                                            <div class="input-group" id="group4MC" style="display: none;">
                                                <span class="input-group-addon">
                                                    <input type="radio" id="answer4MC" name="mc">
                                                </span>
                                                <input type="text" class="form-control" id="select4MC" value="" readonly>
                                            </div>
                                            <div class="input-group" id="group5MC" style="display: none;">
                                                <span class="input-group-addon">
                                                    <input type="radio" id="answer5MC" name="mc">
                                                </span>
                                                <input type="text" class="form-control" id="select5MC" value="" readonly>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-xs-12 col-sm-6 col-md-4">
                                        <br />
                                        <input type="submit" class="btn btn-block btn-default">
                                        <br />
                                    </div>
                                </div>
                            </form>
                            <h4>
                                <span id="answerResultMC"></span>
                            </h4>
                        </div>
                    </div>
                    <div id="trueFalsePanel" class="panel panel-default" style="display: none;">
                        <div class="panel-body">
                            <form id="trueFalseForm">
                                <div class="row">
                                    <div class="col-xs-12">
                                        <div class="form-group">
                                            <label for="trueFalseQuestion">Question:</label>
                                            <h4><div id="trueFalseQuestion"></div></h4>
                                        </div>
                                        <div class="form-group">
                                            <div class="form-group">
                                                <div class="radio">
                                                    <label><input type="radio" name="answerTF" id="radioTrue" value="true">True</label>
                                                </div>
                                                <div class="radio">
                                                    <label><input type="radio" name="answerTF" id="radioFalse" value="false">False</label>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-xs-12 col-sm-6 col-md-4">
                                        <br />
                                        <input type="submit" class="btn btn-block btn-default">
                                        <br />
                                    </div>
                                </div>
                            </form>
                            <h4>
                                <span id="answerResultTF"></span>
                            </h4>
                        </div>
                    </div>
                </div>
                <div class="col-xs-12">
                    <div id="timerPanel" class="panel panel-default" style="display: none;">
                        <div class="panel-body">
                            <div class="row">
                                <div class="col-xs-12">
                                    <h3>
                                        Time Remaining:
                                        <strong><span id="timerHolder"></span></strong>
                                    </h3>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <script src="https://cdn.socket.io/socket.io-1.4.5.js"></script>
        <script src="https://code.jquery.com/jquery-1.11.1.js"></script>
        <script>
            var SOCKET = io();
            var SOCKET_NAME = false;

            var WAITING_PANEL = $("#waitingPanel");
            var TIMER_PANEL = $("#timerPanel");
            var TIMER_HOLDER = $("#timerHolder");

            var NAME_FORM_PANEL = $("#studentNameFormPanel");
            var NAME_FORM = $("#studentNameForm");
            var NAME_INPUT = $("#nameInput");

            var SHORT_ANSWER_PANEL = $("#shortAnswerPanel");
            var SHORT_ANSWER_FORM = $("#shortAnswerForm");
            var SHORT_ANSWER_QUESTION = $("#shortAnswerQuestion");
            var SHORT_ANSWER_ANSWER = $("#shortAnswerAnswer");
            var SHORT_ANSWER_RESULT = $("#answerResult");

            var MULTIPLE_CHOICE_PANEL = $("#multipleChoicePanel");
            var MULTIPLE_CHOICE_FORM = $("#multipleChoiceForm");
            var MULTIPLE_CHOICE_QUESTION = $("#multipleChoiceQuestion");
            var MULTIPLE_CHOICE_GROUP1 = $("#group1MC");
            var MULTIPLE_CHOICE_GROUP1_RADIO = $("#answer1MC");
            var MULTIPLE_CHOICE_GROUP1_VALUE = $("#select1MC");
            var MULTIPLE_CHOICE_GROUP2 = $("#group2MC");
            var MULTIPLE_CHOICE_GROUP2_RADIO = $("#answer2MC");
            var MULTIPLE_CHOICE_GROUP2_VALUE = $("#select2MC");
            var MULTIPLE_CHOICE_GROUP3 = $("#group3MC");
            var MULTIPLE_CHOICE_GROUP3_RADIO = $("#answer3MC");
            var MULTIPLE_CHOICE_GROUP3_VALUE = $("#select3MC");
            var MULTIPLE_CHOICE_GROUP4 = $("#group4MC");
            var MULTIPLE_CHOICE_GROUP4_RADIO = $("#answer4MC");
            var MULTIPLE_CHOICE_GROUP4_VALUE = $("#select4MC");
            var MULTIPLE_CHOICE_GROUP5 = $("#group5MC");
            var MULTIPLE_CHOICE_GROUP5_RADIO = $("#answer5MC");
            var MULTIPLE_CHOICE_GROUP5_VALUE = $("#select5MC");
            var MULTIPLE_CHOICE_RESULT = $("#answerResultMC");

            var TRUE_FALSE_PANEL = $("#trueFalsePanel");
            var TRUE_FALSE_FORM = $("#trueFalseForm");
            var TRUE_FALSE_QUESTION = $("#trueFalseQuestion");
            var TRUE_FALSE_ANSWER = $("#radioTrue");
            var TRUE_FALSE_RESULT = $("#answerResultTF");

            //An incoming question
            //Will show the proper panel according to the question type
            SOCKET.on('deliver_question', function(data){
                if(SOCKET_NAME !== false) {
                    switch(data.type) {
                        case "SA":
                            activateTimer(data.timer, function() {
                                SHORT_ANSWER_FORM.trigger("reset");
                                SHORT_ANSWER_FORM.hide();
                                SHORT_ANSWER_PANEL.hide();
                                SHORT_ANSWER_QUESTION.html("");
                            });
                            SHORT_ANSWER_PANEL.show();
                            SHORT_ANSWER_FORM.show();
                            SHORT_ANSWER_QUESTION.html(data.question);
                        break;
                        case "TF":
                            activateTimer(data.timer, function() {
                                TRUE_FALSE_FORM.trigger("reset");
                                TRUE_FALSE_FORM.hide();
                                TRUE_FALSE_PANEL.hide();
                                TRUE_FALSE_QUESTION.html("");
                            });
                            TRUE_FALSE_PANEL.show();
                            TRUE_FALSE_FORM.show();
                            TRUE_FALSE_QUESTION.html(data.question);
                        break;
                        case "MC":
                            activateTimer(data.timer, function() {
                                MULTIPLE_CHOICE_FORM.trigger("reset");
                                MULTIPLE_CHOICE_FORM.hide();
                                MULTIPLE_CHOICE_PANEL.hide();
                                MULTIPLE_CHOICE_QUESTION.html("");
                            });
                            MULTIPLE_CHOICE_PANEL.show();
                            MULTIPLE_CHOICE_FORM.show();
                            MULTIPLE_CHOICE_QUESTION.html(data.question);
                            if(data.answer.optionA.value != '') {
                                MULTIPLE_CHOICE_GROUP1.show();
                                MULTIPLE_CHOICE_GROUP1_VALUE.val(data.answer.optionA.value);
                            }
                            else {
                                MULTIPLE_CHOICE_GROUP1.hide();
                            }
                            if(data.answer.optionB.value != '') {
                                MULTIPLE_CHOICE_GROUP2.show();
                                MULTIPLE_CHOICE_GROUP2_VALUE.val(data.answer.optionB.value);
                            }
                            else {
                                MULTIPLE_CHOICE_GROUP2.hide();
                            }
                            if(data.answer.optionC.value != '') {
                                MULTIPLE_CHOICE_GROUP3.show();
                                MULTIPLE_CHOICE_GROUP3_VALUE.val(data.answer.optionC.value);
                            }
                            else {
                                MULTIPLE_CHOICE_GROUP3.hide();
                            }
                            if(data.answer.optionD.value != '') {
                                MULTIPLE_CHOICE_GROUP4.show();
                                MULTIPLE_CHOICE_GROUP4_VALUE.val(data.answer.optionD.value);
                            }
                            else {
                                MULTIPLE_CHOICE_GROUP4.hide();
                            }
                            if(data.answer.optionE.value != '') {
                                MULTIPLE_CHOICE_GROUP5.show();
                                MULTIPLE_CHOICE_GROUP5_VALUE.val(data.answer.optionE.value);
                            }
                            else {
                                MULTIPLE_CHOICE_GROUP5.hide();
                            }
                        break;
                    }
                }
            });

            //This will display the result based on how the student answered
            //The correct answer will display if incorrect
            SOCKET.on('result_question', function(data) {
                if(SOCKET_NAME !== false) {
                    if(data.type == "MC") {
                        if(data.correct) {
                            MULTIPLE_CHOICE_RESULT.html("Correct!");
                        }
                        else {
                            MULTIPLE_CHOICE_RESULT.html("Incorrect!<br/>The correct answer is: " + data.answer);
                        }
                    }
                    else if(data.type == "TF") {
                        if(data.correct) {
                            TRUE_FALSE_RESULT.html("Correct!");
                        }
                        else {
                            TRUE_FALSE_RESULT.html("Incorrect!<br/>The correct answer is: " + data.answer);
                        }
                    }
                    else {
                        if(data.correct) {
                            SHORT_ANSWER_RESULT.html("Correct!");
                        }
                        else {
                            SHORT_ANSWER_RESULT.html("Incorrect!<br/>The correct answer is: " + data.answer);
                        }
                    }
                }
            });

            //When a student enters their name
            //Name entry must be done in order to answer questions
            NAME_FORM.submit(function() {
                SOCKET_NAME = NAME_INPUT.val();
                NAME_FORM_PANEL.hide();
                WAITING_PANEL.show();
                return false;
            });


            //Submit short answer
            SHORT_ANSWER_FORM.submit(function() {
                if(SOCKET_NAME !== false) {
                    var answerData = {
                        name: SOCKET_NAME,
                        type: "SA",
                        answer: SHORT_ANSWER_ANSWER.val()
                    };
                    SOCKET.emit('submit_answer', answerData);
                    SHORT_ANSWER_FORM.hide();
                }
                return false;
            });

            //Submit true or false answer
            TRUE_FALSE_FORM.submit(function() {
                if(SOCKET_NAME !== false) {
                    var answerData = {
                        name: SOCKET_NAME,
                        type: "TF",
                        answer: TRUE_FALSE_ANSWER.is(':checked')
                    };
                    SOCKET.emit('submit_answer', answerData);
                    TRUE_FALSE_FORM.hide();
                }
                return false;
            });

            //Submit multiple choice answer
            MULTIPLE_CHOICE_FORM.submit(function() {
                if(SOCKET_NAME !== false) {
                    var selectedAnswer = "";
                    if(MULTIPLE_CHOICE_GROUP1_RADIO.is(':checked')) {
                        selectedAnswer = MULTIPLE_CHOICE_GROUP1_VALUE.val();
                    }
                    if(MULTIPLE_CHOICE_GROUP2_RADIO.is(':checked')) {
                        selectedAnswer = MULTIPLE_CHOICE_GROUP2_VALUE.val();
                    }
                    if(MULTIPLE_CHOICE_GROUP3_RADIO.is(':checked')) {
                        selectedAnswer = MULTIPLE_CHOICE_GROUP3_VALUE.val();
                    }
                    if(MULTIPLE_CHOICE_GROUP4_RADIO.is(':checked')) {
                        selectedAnswer = MULTIPLE_CHOICE_GROUP4_VALUE.val();
                    }
                    if(MULTIPLE_CHOICE_GROUP5_RADIO.is(':checked')) {
                        selectedAnswer = MULTIPLE_CHOICE_GROUP5_VALUE.val();
                    }
                    var answerData = {
                        name: SOCKET_NAME,
                        type: "MC",
                        answer: selectedAnswer
                    };
                    SOCKET.emit('submit_answer', answerData);
                    MULTIPLE_CHOICE_FORM.hide();
                }
                return false;
            });

            function activateTimer(time, callback) {
                var timeRemaining = time;
                TIMER_PANEL.show();
                TIMER_HOLDER.html(timeRemaining);
                WAITING_PANEL.hide();
                var timeInterval = setInterval(function() {
                    TIMER_HOLDER.html(--timeRemaining);
                    if(timeRemaining <= 0) {
                        TIMER_PANEL.hide();
                        WAITING_PANEL.show();
                        clearInterval(timeInterval);
                        if(callback !== undefined) {
                            callback();
                        }
                    }
                }, 1000);
            }
        </script>
    </body>
</html>
